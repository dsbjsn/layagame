{
  "code": "import SignModle from \"../../modle/SignModle\";\r\nimport ConfigData from \"../../config/ConfigData\";\r\nimport WxADUtil from \"../../utils/WxADUtil\";\r\nimport StaticData from \"../../data/StaticData\";\r\nimport BaseDialogManage from \"../dialogManage/BaseDialogManage\";\r\nexport default class SignManage extends BaseDialogManage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.isChecked = true;\r\n    }\r\n    onEnable() {\r\n        super.onEnable();\r\n        this.contentSpr.y += StaticData.offY;\r\n        let cancelSpr = this.contentSpr.getChildByName(\"cancelSpr\");\r\n        let doSign = this.contentSpr.getChildByName(\"doSign\");\r\n        let signBox = this.contentSpr.getChildByName(\"signBox\");\r\n        cancelSpr.on(Laya.Event.CLICK, this, () => {\r\n            this.owner.close();\r\n        });\r\n        doSign.on(Laya.Event.CLICK, this, () => {\r\n            if (SignModle.getTodaySigned()) {\r\n                this.owner.close();\r\n            }\r\n            else {\r\n                if (this.isChecked) {\r\n                    WxADUtil.adOrShare({\r\n                        success: () => {\r\n                            SignModle.sign(true);\r\n                            this.owner.close();\r\n                        },\r\n                        fail: () => {\r\n                            SignModle.sign(false);\r\n                            this.owner.close();\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    SignModle.sign(false);\r\n                    this.owner.close();\r\n                }\r\n            }\r\n        });\r\n        this.initSignDay();\r\n        if (SignModle.getTodaySigned()) {\r\n            doSign.loadImage(\"images/sign_tomorrow.png\");\r\n        }\r\n        this.checkBox = this.contentSpr.getChildByName(\"checkBox\");\r\n        this.checkLb = this.contentSpr.getChildByName(\"checkLb\");\r\n        this.checkBox.visible = !SignModle.getTodaySigned();\r\n        this.checkLb.visible = !SignModle.getTodaySigned();\r\n        this.checkBox.on(Laya.Event.CLICK, this, this.checkAction);\r\n        this.checkLb.on(Laya.Event.CLICK, this, this.checkAction);\r\n    }\r\n    checkAction() {\r\n        this.isChecked = !this.isChecked;\r\n        if (this.isChecked) {\r\n            this.checkBox.loadImage(\"images/box_select.png\");\r\n        }\r\n        else {\r\n            this.checkBox.loadImage(\"images/box_unselect.png\");\r\n        }\r\n    }\r\n    initSignDay() {\r\n        let signBox = this.contentSpr.getChildByName(\"signBox\");\r\n        this.day1 = signBox.getChildByName(\"day1\");\r\n        this.day2 = signBox.getChildByName(\"day2\");\r\n        this.day3 = signBox.getChildByName(\"day3\");\r\n        this.day4 = signBox.getChildByName(\"day4\");\r\n        this.day5 = signBox.getChildByName(\"day5\");\r\n        this.day6 = signBox.getChildByName(\"day6\");\r\n        this.day7 = signBox.getChildByName(\"day7\");\r\n        this.daySprs = [this.day1, this.day2, this.day3, this.day4, this.day5, this.day6, this.day7];\r\n        this.setSignData();\r\n    }\r\n    setSignData() {\r\n        for (let i = 0; i < this.daySprs.length; i++) {\r\n            if (i < 6) {\r\n                let daySignedBgSpr = this.daySprs[i].getChildByName(\"daySignedBgSpr\");\r\n                let dayBgSpr = this.daySprs[i].getChildByName(\"dayBgSpr\");\r\n                let dayLb = this.daySprs[i].getChildByName(\"dayLb\");\r\n                let coinLb = this.daySprs[i].getChildByName(\"coinLb\");\r\n                let maskSpr = this.daySprs[i].getChildByName(\"maskSpr\");\r\n                dayLb.text = \"第\" + (i + 1) + \"天\";\r\n                coinLb.text = String(SignModle.coinNum[i]);\r\n                if (i < SignModle.getSignDays()) {\r\n                    daySignedBgSpr.visible = true;\r\n                    maskSpr.visible = true;\r\n                    dayBgSpr.visible = false;\r\n                }\r\n                else if (i == SignModle.getSignDays() && SignModle.getSignDays() < 5 && !SignModle.getTodaySigned()) {\r\n                    daySignedBgSpr.visible = true;\r\n                    maskSpr.visible = false;\r\n                    dayBgSpr.visible = false;\r\n                }\r\n                else {\r\n                    daySignedBgSpr.visible = false;\r\n                    maskSpr.visible = false;\r\n                    dayBgSpr.visible = true;\r\n                }\r\n            }\r\n            else {\r\n                let signAwardLb = this.daySprs[i].getChildByName(\"signAwardLb\");\r\n                let imgSpr = this.daySprs[i].getChildByName(\"imgSpr\");\r\n                let maskSpr = this.daySprs[i].getChildByName(\"maskSpr\");\r\n                if (SignModle.hadCarAward == 0) {\r\n                    signAwardLb.text = SignModle.carAward.name;\r\n                    imgSpr.loadImage(SignModle.carAward.img);\r\n                    imgSpr.pos(SignModle.carAward.x, SignModle.carAward.y);\r\n                }\r\n                else {\r\n                    signAwardLb.text = String(SignModle.coinNum[i]) + \" 金币\";\r\n                    imgSpr.loadImage(\"images/award_coin.png\");\r\n                }\r\n                if (SignModle.getSignDays() == 7 && SignModle.getTodaySigned()) {\r\n                    maskSpr.visible = true;\r\n                }\r\n                else {\r\n                    maskSpr.visible = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    onDisable() {\r\n        super.onDisable();\r\n        Laya.Dialog.open(ConfigData.StartGameDialog);\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaModle/melee/src/modle/SignModle.ts",
    "E:/LayaModle/melee/src/config/ConfigData.ts",
    "E:/LayaModle/melee/src/utils/WxADUtil.ts",
    "E:/LayaModle/melee/src/modle/CoinModle.ts",
    "E:/LayaModle/melee/src/data/StaticData.ts",
    "E:/LayaModle/melee/src/manages/dialogManage/BaseDialogManage.ts"
  ]
}
