{
  "code": "export class md5 {\r\n    constructor() {\r\n        this.hexcase = 0;\r\n        this.b64pad = \"\";\r\n    }\r\n    hex_md5(s) { return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(s))); }\r\n    b64_md5(s) { return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(s))); }\r\n    any_md5(s, e) { return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(s)), e); }\r\n    hex_hmac_md5(k, d) { return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(k), this.str2rstr_utf8(d))); }\r\n    b64_hmac_md5(k, d) { return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(k), this.str2rstr_utf8(d))); }\r\n    any_hmac_md5(k, d, e) { return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(k), this.str2rstr_utf8(d)), e); }\r\n    md5_vm_test() {\r\n        return this.hex_md5(\"abc\").toLowerCase() == \"900150983cd24fb0d6963f7d28e17f72\";\r\n    }\r\n    rstr_md5(s) {\r\n        return this.binl2rstr(this.binl_md5(this.rstr2binl(s), s.length * 8));\r\n    }\r\n    rstr_hmac_md5(key, data) {\r\n        var bkey = this.rstr2binl(key);\r\n        if (bkey.length > 16)\r\n            bkey = this.binl_md5(bkey, key.length * 8);\r\n        var ipad = Array(16), opad = Array(16);\r\n        for (var i = 0; i < 16; i++) {\r\n            ipad[i] = bkey[i] ^ 0x36363636;\r\n            opad[i] = bkey[i] ^ 0x5C5C5C5C;\r\n        }\r\n        var hash = this.binl_md5(ipad.concat(this.rstr2binl(data)), 512 + data.length * 8);\r\n        return this.binl2rstr(this.binl_md5(opad.concat(hash), 512 + 128));\r\n    }\r\n    rstr2hex(input) {\r\n        try {\r\n            this.hexcase;\r\n        }\r\n        catch (e) {\r\n            this.hexcase = 0;\r\n        }\r\n        var hex_tab = this.hexcase ? \"0123456789ABCDEF\" : \"0123456789abcdef\";\r\n        var output = \"\";\r\n        var x;\r\n        for (var i = 0; i < input.length; i++) {\r\n            x = input.charCodeAt(i);\r\n            output += hex_tab.charAt((x >>> 4) & 0x0F)\r\n                + hex_tab.charAt(x & 0x0F);\r\n        }\r\n        return output;\r\n    }\r\n    rstr2b64(input) {\r\n        try {\r\n            this.b64pad;\r\n        }\r\n        catch (e) {\r\n            this.b64pad = '';\r\n        }\r\n        var tab = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n        var output = \"\";\r\n        var len = input.length;\r\n        for (var i = 0; i < len; i += 3) {\r\n            var triplet = (input.charCodeAt(i) << 16)\r\n                | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0)\r\n                | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\r\n            for (var j = 0; j < 4; j++) {\r\n                if (i * 8 + j * 6 > input.length * 8)\r\n                    output += this.b64pad;\r\n                else\r\n                    output += tab.charAt((triplet >>> 6 * (3 - j)) & 0x3F);\r\n            }\r\n        }\r\n        return output;\r\n    }\r\n    rstr2any(input, encoding) {\r\n        var divisor = encoding.length;\r\n        var i, j, q, x, quotient;\r\n        var dividend = Array(Math.ceil(input.length / 2));\r\n        for (i = 0; i < dividend.length; i++) {\r\n            dividend[i] = (input.charCodeAt(i * 2) << 8) | input.charCodeAt(i * 2 + 1);\r\n        }\r\n        var full_length = Math.ceil(input.length * 8 /\r\n            (Math.log(encoding.length) / Math.log(2)));\r\n        var remainders = Array(full_length);\r\n        for (j = 0; j < full_length; j++) {\r\n            quotient = Array();\r\n            x = 0;\r\n            for (i = 0; i < dividend.length; i++) {\r\n                x = (x << 16) + dividend[i];\r\n                q = Math.floor(x / divisor);\r\n                x -= q * divisor;\r\n                if (quotient.length > 0 || q > 0)\r\n                    quotient[quotient.length] = q;\r\n            }\r\n            remainders[j] = x;\r\n            dividend = quotient;\r\n        }\r\n        var output = \"\";\r\n        for (i = remainders.length - 1; i >= 0; i--)\r\n            output += encoding.charAt(remainders[i]);\r\n        return output;\r\n    }\r\n    str2rstr_utf8(input) {\r\n        var output = \"\";\r\n        var i = -1;\r\n        var x, y;\r\n        while (++i < input.length) {\r\n            x = input.charCodeAt(i);\r\n            y = i + 1 < input.length ? input.charCodeAt(i + 1) : 0;\r\n            if (0xD800 <= x && x <= 0xDBFF && 0xDC00 <= y && y <= 0xDFFF) {\r\n                x = 0x10000 + ((x & 0x03FF) << 10) + (y & 0x03FF);\r\n                i++;\r\n            }\r\n            if (x <= 0x7F)\r\n                output += String.fromCharCode(x);\r\n            else if (x <= 0x7FF)\r\n                output += String.fromCharCode(0xC0 | ((x >>> 6) & 0x1F), 0x80 | (x & 0x3F));\r\n            else if (x <= 0xFFFF)\r\n                output += String.fromCharCode(0xE0 | ((x >>> 12) & 0x0F), 0x80 | ((x >>> 6) & 0x3F), 0x80 | (x & 0x3F));\r\n            else if (x <= 0x1FFFFF)\r\n                output += String.fromCharCode(0xF0 | ((x >>> 18) & 0x07), 0x80 | ((x >>> 12) & 0x3F), 0x80 | ((x >>> 6) & 0x3F), 0x80 | (x & 0x3F));\r\n        }\r\n        return output;\r\n    }\r\n    str2rstr_utf16le(input) {\r\n        var output = \"\";\r\n        for (var i = 0; i < input.length; i++)\r\n            output += String.fromCharCode(input.charCodeAt(i) & 0xFF, (input.charCodeAt(i) >>> 8) & 0xFF);\r\n        return output;\r\n    }\r\n    str2rstr_utf16be(input) {\r\n        var output = \"\";\r\n        for (var i = 0; i < input.length; i++)\r\n            output += String.fromCharCode((input.charCodeAt(i) >>> 8) & 0xFF, input.charCodeAt(i) & 0xFF);\r\n        return output;\r\n    }\r\n    rstr2binl(input) {\r\n        var output = Array(input.length >> 2);\r\n        for (var i = 0; i < output.length; i++)\r\n            output[i] = 0;\r\n        for (var i = 0; i < input.length * 8; i += 8)\r\n            output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (i % 32);\r\n        return output;\r\n    }\r\n    binl2rstr(input) {\r\n        var output = \"\";\r\n        for (var i = 0; i < input.length * 32; i += 8)\r\n            output += String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xFF);\r\n        return output;\r\n    }\r\n    binl_md5(x, len) {\r\n        x[len >> 5] |= 0x80 << ((len) % 32);\r\n        x[(((len + 64) >>> 9) << 4) + 14] = len;\r\n        var a = 1732584193;\r\n        var b = -271733879;\r\n        var c = -1732584194;\r\n        var d = 271733878;\r\n        for (var i = 0; i < x.length; i += 16) {\r\n            var olda = a;\r\n            var oldb = b;\r\n            var oldc = c;\r\n            var oldd = d;\r\n            a = this.md5_ff(a, b, c, d, x[i + 0], 7, -680876936);\r\n            d = this.md5_ff(d, a, b, c, x[i + 1], 12, -389564586);\r\n            c = this.md5_ff(c, d, a, b, x[i + 2], 17, 606105819);\r\n            b = this.md5_ff(b, c, d, a, x[i + 3], 22, -1044525330);\r\n            a = this.md5_ff(a, b, c, d, x[i + 4], 7, -176418897);\r\n            d = this.md5_ff(d, a, b, c, x[i + 5], 12, 1200080426);\r\n            c = this.md5_ff(c, d, a, b, x[i + 6], 17, -1473231341);\r\n            b = this.md5_ff(b, c, d, a, x[i + 7], 22, -45705983);\r\n            a = this.md5_ff(a, b, c, d, x[i + 8], 7, 1770035416);\r\n            d = this.md5_ff(d, a, b, c, x[i + 9], 12, -1958414417);\r\n            c = this.md5_ff(c, d, a, b, x[i + 10], 17, -42063);\r\n            b = this.md5_ff(b, c, d, a, x[i + 11], 22, -1990404162);\r\n            a = this.md5_ff(a, b, c, d, x[i + 12], 7, 1804603682);\r\n            d = this.md5_ff(d, a, b, c, x[i + 13], 12, -40341101);\r\n            c = this.md5_ff(c, d, a, b, x[i + 14], 17, -1502002290);\r\n            b = this.md5_ff(b, c, d, a, x[i + 15], 22, 1236535329);\r\n            a = this.md5_gg(a, b, c, d, x[i + 1], 5, -165796510);\r\n            d = this.md5_gg(d, a, b, c, x[i + 6], 9, -1069501632);\r\n            c = this.md5_gg(c, d, a, b, x[i + 11], 14, 643717713);\r\n            b = this.md5_gg(b, c, d, a, x[i + 0], 20, -373897302);\r\n            a = this.md5_gg(a, b, c, d, x[i + 5], 5, -701558691);\r\n            d = this.md5_gg(d, a, b, c, x[i + 10], 9, 38016083);\r\n            c = this.md5_gg(c, d, a, b, x[i + 15], 14, -660478335);\r\n            b = this.md5_gg(b, c, d, a, x[i + 4], 20, -405537848);\r\n            a = this.md5_gg(a, b, c, d, x[i + 9], 5, 568446438);\r\n            d = this.md5_gg(d, a, b, c, x[i + 14], 9, -1019803690);\r\n            c = this.md5_gg(c, d, a, b, x[i + 3], 14, -187363961);\r\n            b = this.md5_gg(b, c, d, a, x[i + 8], 20, 1163531501);\r\n            a = this.md5_gg(a, b, c, d, x[i + 13], 5, -1444681467);\r\n            d = this.md5_gg(d, a, b, c, x[i + 2], 9, -51403784);\r\n            c = this.md5_gg(c, d, a, b, x[i + 7], 14, 1735328473);\r\n            b = this.md5_gg(b, c, d, a, x[i + 12], 20, -1926607734);\r\n            a = this.md5_hh(a, b, c, d, x[i + 5], 4, -378558);\r\n            d = this.md5_hh(d, a, b, c, x[i + 8], 11, -2022574463);\r\n            c = this.md5_hh(c, d, a, b, x[i + 11], 16, 1839030562);\r\n            b = this.md5_hh(b, c, d, a, x[i + 14], 23, -35309556);\r\n            a = this.md5_hh(a, b, c, d, x[i + 1], 4, -1530992060);\r\n            d = this.md5_hh(d, a, b, c, x[i + 4], 11, 1272893353);\r\n            c = this.md5_hh(c, d, a, b, x[i + 7], 16, -155497632);\r\n            b = this.md5_hh(b, c, d, a, x[i + 10], 23, -1094730640);\r\n            a = this.md5_hh(a, b, c, d, x[i + 13], 4, 681279174);\r\n            d = this.md5_hh(d, a, b, c, x[i + 0], 11, -358537222);\r\n            c = this.md5_hh(c, d, a, b, x[i + 3], 16, -722521979);\r\n            b = this.md5_hh(b, c, d, a, x[i + 6], 23, 76029189);\r\n            a = this.md5_hh(a, b, c, d, x[i + 9], 4, -640364487);\r\n            d = this.md5_hh(d, a, b, c, x[i + 12], 11, -421815835);\r\n            c = this.md5_hh(c, d, a, b, x[i + 15], 16, 530742520);\r\n            b = this.md5_hh(b, c, d, a, x[i + 2], 23, -995338651);\r\n            a = this.md5_ii(a, b, c, d, x[i + 0], 6, -198630844);\r\n            d = this.md5_ii(d, a, b, c, x[i + 7], 10, 1126891415);\r\n            c = this.md5_ii(c, d, a, b, x[i + 14], 15, -1416354905);\r\n            b = this.md5_ii(b, c, d, a, x[i + 5], 21, -57434055);\r\n            a = this.md5_ii(a, b, c, d, x[i + 12], 6, 1700485571);\r\n            d = this.md5_ii(d, a, b, c, x[i + 3], 10, -1894986606);\r\n            c = this.md5_ii(c, d, a, b, x[i + 10], 15, -1051523);\r\n            b = this.md5_ii(b, c, d, a, x[i + 1], 21, -2054922799);\r\n            a = this.md5_ii(a, b, c, d, x[i + 8], 6, 1873313359);\r\n            d = this.md5_ii(d, a, b, c, x[i + 15], 10, -30611744);\r\n            c = this.md5_ii(c, d, a, b, x[i + 6], 15, -1560198380);\r\n            b = this.md5_ii(b, c, d, a, x[i + 13], 21, 1309151649);\r\n            a = this.md5_ii(a, b, c, d, x[i + 4], 6, -145523070);\r\n            d = this.md5_ii(d, a, b, c, x[i + 11], 10, -1120210379);\r\n            c = this.md5_ii(c, d, a, b, x[i + 2], 15, 718787259);\r\n            b = this.md5_ii(b, c, d, a, x[i + 9], 21, -343485551);\r\n            a = this.safe_add(a, olda);\r\n            b = this.safe_add(b, oldb);\r\n            c = this.safe_add(c, oldc);\r\n            d = this.safe_add(d, oldd);\r\n        }\r\n        return [a, b, c, d];\r\n    }\r\n    md5_cmn(q, a, b, x, s, t) {\r\n        return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(a, q), this.safe_add(x, t)), s), b);\r\n    }\r\n    md5_ff(a, b, c, d, x, s, t) {\r\n        return this.md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    }\r\n    md5_gg(a, b, c, d, x, s, t) {\r\n        return this.md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    }\r\n    md5_hh(a, b, c, d, x, s, t) {\r\n        return this.md5_cmn(b ^ c ^ d, a, b, x, s, t);\r\n    }\r\n    md5_ii(a, b, c, d, x, s, t) {\r\n        return this.md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    }\r\n    safe_add(x, y) {\r\n        var lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n        var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n        return (msw << 16) | (lsw & 0xFFFF);\r\n    }\r\n    bit_rol(num, cnt) {\r\n        return (num << cnt) | (num >>> (32 - cnt));\r\n    }\r\n}\r\n",
  "references": []
}
