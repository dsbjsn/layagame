{
  "code": "import BaseDialogManage from \"./BaseDialogManage\";\r\nimport CoinModle from \"../../modle/CoinModle\";\r\nimport AldUtil from \"../../utils/AldUtil\";\r\nimport StaticData from \"../../data/StaticData\";\r\nimport ConfigData from \"../../config/ConfigData\";\r\nimport GameManage from \"../../manages/GameManage\";\r\nimport GameState from \"../../data/GameState\";\r\nimport WxADUtil from \"../../utils/WxADUtil\";\r\nimport GamePlatform from \"../../adapter/GamePlatform\";\r\nimport SignModle from \"../../modle/SignModle\";\r\nexport default class GameFinishDialogManage extends BaseDialogManage {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.hadShare = false;\r\n    }\r\n    findView() {\r\n        this._title = this.contentSpr.getChildByName(\"_title\");\r\n        this.stationLb = this.contentSpr.getChildByName(\"stationLb\");\r\n        this.yesBox = this.contentSpr.getChildByName(\"yesBox\");\r\n        this.yesSpr = this.yesBox.getChildByName(\"yesSpr\");\r\n        this.changeBtn = this.yesBox.getChildByName(\"changeBtn\");\r\n        this.goHomeBtn = this.yesBox.getChildByName(\"goHomeBtn\");\r\n        this.awardBtn = this.yesBox.getChildByName(\"awardBtn\");\r\n        this.fcSpr = this.awardBtn.getChildByName(\"fcSpr\");\r\n        this.fcNumLb = this.fcSpr.getChildByName(\"fcNumLb\");\r\n        this.addGame = this.owner.getChildByName(\"addGame\");\r\n    }\r\n    initView() {\r\n        this.fcNumLb.text = StaticData.ChangeFriendGetCoin + \"\";\r\n        this.stationLb.text = \"- 下一站 \" + StaticData.getLevelData(StaticData.level).stationInfo.name + \" -\";\r\n        this.changeBtn.on(Laya.Event.CLICK, this, this.onClickAction);\r\n        this.goHomeBtn.on(Laya.Event.CLICK, this, this.onClickAction);\r\n        this.awardBtn.on(Laya.Event.CLICK, this, this.onClickAction);\r\n        if (GamePlatform.platformName != GamePlatform.WX && GamePlatform.platformName != GamePlatform.QQ) {\r\n            this.addGame.visible = false;\r\n        }\r\n        this.yesSpr.on(Laya.Event.CLICK, this, () => {\r\n            this.yesAction();\r\n        });\r\n    }\r\n    ;\r\n    initData() {\r\n        if (Laya.Browser.onWeiXin || Laya.Browser.onQQMiniGame) {\r\n            let open = GamePlatform.openDataContext.createDisplayObject();\r\n            open.postMsg({ command: \"set_score\", score: StaticData.level, station_name: \"第\" + StaticData.level + \"关\" });\r\n        }\r\n        if (GamePlatform.platformName != GamePlatform.WX && GamePlatform.platformName != GamePlatform.QQ) {\r\n            this.changeBtn.visible = false;\r\n            this.awardBtn.visible = false;\r\n        }\r\n    }\r\n    adapterWindow() {\r\n        super.adapterWindow();\r\n        this._title.y += 167 * StaticData.heightOffsetScale;\r\n        this.stationLb.y += 167 * StaticData.heightOffsetScale;\r\n        this.yesBox.y += 248 * StaticData.heightOffsetScale;\r\n        if (Laya.Browser.onWeiXin || Laya.Browser.onQQMiniGame) {\r\n            let data = GamePlatform.platform.getMenuButtonBoundingClientRect();\r\n            let off = (data.height * StaticData.clientScale - this.addGame.height) / 2;\r\n            this.addGame.y = data.top * StaticData.clientScale + off;\r\n        }\r\n    }\r\n    setLeadOutData() {\r\n        this.midleLeadOutSpr.setAldPois(\"\\u6E38\\u620F\\u7ED3\\u675F\\u9875-\\u5BFC\\u51FA\");\r\n        this.setIsShowMisLead(StaticData.isMisLead, this.yesBox);\r\n    }\r\n    onClickAction(e) {\r\n        switch (e.target.name) {\r\n            case \"changeBtn\":\r\n            case \"awardBtn\":\r\n                AldUtil.upload(\"\\u6E38\\u620F\\u7ED3\\u675F\\u9875-\\u5206\\u4EAB\");\r\n                WxADUtil.share({\r\n                    success: () => {\r\n                        if (!this.hadShare) {\r\n                            CoinModle.addCoin(StaticData.ChangeFriendGetCoin);\r\n                            this.hadShare = true;\r\n                        }\r\n                    }\r\n                });\r\n                break;\r\n            case \"goHomeBtn\":\r\n                this.gotoHome();\r\n                break;\r\n            default: break;\r\n        }\r\n    }\r\n    yesAction() {\r\n        this.reStart();\r\n    }\r\n    reStart() {\r\n        AldUtil.upload(\"\\u6E38\\u620F\\u7ED3\\u675F\\u9875-\\u518D\\u6765\\u4E00\\u6B21\");\r\n        GameManage.manageOwner.gameState = GameState.NOT_START;\r\n        GameManage.manageOwner.restart(true);\r\n        this.owner.close();\r\n    }\r\n    gotoHome() {\r\n        AldUtil.upload(\"\\u6E38\\u620F\\u7ED3\\u675F\\u9875-\\u8FD4\\u56DE\\u9996\\u9875\");\r\n        GameManage.manageOwner.refreshUI();\r\n        Laya.Dialog.open(ConfigData.StartGameDialog);\r\n        Laya.Dialog.open(ConfigData.StartGameDialog, true, null, Laya.Handler.create(this, (dialog) => {\r\n            if (StaticData.AutoSkipToSign && !SignModle.getTodaySigned()) {\r\n                let d = dialog;\r\n                Laya.timer.once(1000, this, () => {\r\n                    if (d && !d.destroyed && d.visible) {\r\n                        StaticData.AutoSkipToSign = false;\r\n                        Laya.Dialog.open(ConfigData.SignDialog);\r\n                    }\r\n                });\r\n            }\r\n        }));\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaModle/melee/src/manages/dialogManage/BaseDialogManage.ts",
    "E:/LayaModle/melee/src/modle/SkinModle.ts",
    "E:/LayaModle/melee/src/modle/CoinModle.ts",
    "E:/LayaModle/melee/src/data/GameHttp.ts",
    "E:/LayaModle/melee/src/utils/AldUtil.ts",
    "E:/LayaModle/melee/src/data/StaticData.ts",
    "E:/LayaModle/melee/src/config/ConfigData.ts",
    "E:/LayaModle/melee/src/runtimes/LeadOutGridRunTime.ts",
    "E:/LayaModle/melee/src/manages/GameManage.ts",
    "E:/LayaModle/melee/src/data/GameState.ts",
    "E:/LayaModle/melee/src/utils/LeadOutUtil.ts",
    "E:/LayaModle/melee/src/utils/WxADUtil.ts",
    "E:/LayaModle/melee/src/adapter/GamePlatform.ts",
    "E:/LayaModle/melee/src/modle/SignModle.ts"
  ]
}
